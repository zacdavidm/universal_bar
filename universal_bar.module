<?php
function curPageURL() {
 $pageURL = 'http';
 if (isset($_SERVER["HTTPS"]) && $_SERVER["HTTPS"]== "on") {$pageURL .= "s";}
 $pageURL .= "://";
 if ($_SERVER["SERVER_PORT"] != "80") {
  $pageURL .= $_SERVER["SERVER_NAME"].":".$_SERVER["SERVER_PORT"].$_SERVER["REQUEST_URI"];
 } else {
  $pageURL .= $_SERVER["SERVER_NAME"].$_SERVER["REQUEST_URI"];
 }
 return $pageURL;
}
function universal_bar_page_alter(&$page){
	$account_in_out;
	$account_user="";
	$feedback_ref=urlencode(curPageURL());
	if(user_is_logged_in()){
		$account_user='<li><a href="https://forgoodaccounts.pairsite.com/user">Account</a></li>';
		$account_in_out='<a href="https://forgoodaccounts.pairsite.com/user/logout">Sign Out</a>';
	}else{
		$account_user='<li><a href="https://forgoodaccounts.pairsite.com/user/register" class="button small">Create Account</a></li>';
		$account_in_out='<a href="https://forgoodaccounts.pairsite.com/user/login">Sign In</a>';
	}
	$sites_list='
	<div class="display-panel">
		<ul class="sites-list small-block-grid-1 menu">
			<li><a href="http://forgoodstudios.org">Forgood Studios</a></li>
			<li><a href="http://housing.forgoodstudios.org">Forgood Housing</a></li>
			<li><a href="http://reddit.com/r/forgoodideas">Forgood Ideas</a></li>
			<li><a href="http://forgoodaccounts.pairsite.com">Forgood Accounts</a></li>
			<li><a href="http://redjacketarts.com">Redjacket Arts</a></li>
		</ul>
		<div class="display-panel-footer">
			<a href="https://forgoodaccounts.pairsite.com/site-descriptions">Site Descriptions</a>
		</div>
	</div>';
	$notifications=
	'<div class="display-panel">
	<div id="notifications"></div>
	<div class="display-panel-footer">
		<a href="https://forgoodaccounts.pairsite.com/notifications">Notifications Manager</a>
	</div>
	</div>';
    $page['page_top']['universal_bar']=array(
    '#markup'=>
    '<div class="universal-bar">
		<div class="row">
			<div class="right">
				<ul class="menu inline-list">
					'.$account_user.'
					<li id="toggle-sites-list"><a title="Sites"><i class="fa fa-th"><span class="element-invisible">Sites</span></i></a>
						'.$sites_list.'
					</li>
					<li id="toggle-notifications"><a title="Notifications"><i class="fa fa-bell"><span class="element-invisible">Notifications</span></i><span class="notif-count"></span></a>
						'.$notifications.'
					</li>
					<li><a href="https://forgoodaccounts.pairsite.com/feedback?ref='.$feedback_ref.'" title="Feedback"><i class="fa fa-question-circle"><span class="element-invisible">Feedback</span></i></a>
						'.$notifications.'
					</li>
					<li>'.$account_in_out.'</li>
				</ul>
			</div>
		</div>
    </div>',
    '#weight' => 26,
    );

}
